# ElGamal encryption

**Алгоритм Эль-Гамаля** — асимметричный алгоритм с открытым ключом, основанный на трудности вычисления дискретных логарифмов в конечном поле. Разработан Т. Эль-Гамалем в 1985 г.

[Wiki](https://ru.wikipedia.org/wiki/%D0%A1%D1%85%D0%B5%D0%BC%D0%B0_%D0%AD%D0%BB%D1%8C-%D0%93%D0%B0%D0%BC%D0%B0%D0%BB%D1%8F)

Выбираются случайным образом некоторое большое простое число p и число g - первообразный корень по модулю p. Эти числа передаются в открытом виде.

Затем выбирается закрытый ключ `x: 1 < xi < p-1`, и вычисляется открытый ключ `y = g^x mod p`.

Шифрование исходного сообщения происходит посимвольно, причем каждый символ должен быть представлен числом `M < p`. Для этого выбирается случайное число `k: 1 < k < p-1` для каждого символа сообщения, после чего шифротекст генерируется по следующим формулам:
	
	r = g^k mod p
	e = M * y^k mod p
	
Таким образом, пара чисел `(r, e)` для каждого символа сообщения является шифротекстом и в таком виде передается собеседнику.

Особенностью криптосистемы Эль-Гамаля является участие в процессе шифрования случайного числа `k`, поэтому при повторном шифровании одного и того же открытого сообщения криптограммы будут различны.

Собеседник может расшифровать полученный шифротекст, зная закрытый ключ `x`, по формуле:
	
	M = e(r)^(-1) mod p

Программа показывает, в каком виде передавалось бы зашифрованное сообщение абоненту, а также, как получатель по секретному ключу может восстановить исходное сообщение.

Можно зашифровывать сообщения как на английском, так и на русском языке.


## Пример

	Исходное сообщение: Hello!
	p = 3491 
	g = 1218 
	x = 1376 
	y = 3199 

        Пояснение        |          Данные шифрования             
-------------------------|------|------|------|------|------|------
  **Символ сообщения**   |  H   |  e   |  l   |  l   |  o   |  !   
     **Код символа**     |  72  | 101  | 108  | 108  | 111  |  33  
  **Случайное число k**  | 2158 | 1619 | 1663 | 1858 | 3363 | 2293 
 **Часть шифротекста r** | 1425 | 998  | 614  | 1124 | 2053 | 3157 
 **Часть шифротекста e** | 3475 | 273  | 2851 | 2566 | 3456 | 1892 


## Пример запуска:
	
	$ python3 main.py


## Дополнительные файлы:

	- prime_numbers.txt - список первых 500 простых чисел
	
 